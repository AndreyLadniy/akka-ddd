<html><head><title>Akka-DDD</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Paweł Kaczor" /><meta name="description" content="Scala CQRS/ES framework" /><meta name="og:image" content="/akka-ddd/img/poster.png" /><meta name="og:title" content="Akka-DDD" /><meta name="og:site_name" content="Akka-DDD" /><meta name="og:url" content="http://github.com/pawelkaczor/akka-ddd" /><meta name="og:type" content="website" /><meta name="og:description" content="Scala CQRS/ES framework" /><link rel="icon" type="image/png" href="/akka-ddd/img/favicon.png" /><meta name="twitter:title" content="Akka-DDD" /><meta name="twitter:image" content="http://github.com/pawelkaczor/akka-dddimg/poster.png" /><meta name="twitter:description" content="Scala CQRS/ES framework" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/akka-ddd/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/akka-ddd/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/akka-ddd/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/akka-ddd/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/akka-ddd/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/akka-ddd/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/akka-ddd/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/akka-ddd/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/akka-ddd/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/akka-ddd/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/akka-ddd/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/akka-ddd/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/akka-ddd/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/akka-ddd/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/akka-ddd/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/akka-ddd/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/akka-ddd/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/akka-ddd/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/akka-ddd/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/akka-ddd/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/akka-ddd/highlight/styles/color-brewer.css" /><link rel="stylesheet" href="/akka-ddd/css/style.css" /><link rel="stylesheet" href="/akka-ddd/css/palette.css" /><link rel="stylesheet" href="/akka-ddd/css/codemirror.css" /><link rel="stylesheet" href="/akka-ddd/css/kazari-style.css" /><link rel="stylesheet" href="/akka-ddd/css/monokai.css" /><link rel="stylesheet" href="/akka-ddd/css/override.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/akka-ddd/" class="brand"><div class="brand-wrapper"><span>Akka-DDD</span></div></a></li> <li><a href="/akka-ddd/index.html" class="">Introduction</a></li> <li><a href="/akka-ddd/docs/getting-started.html" class="">Getting Started</a></li> <li><a href="/akka-ddd/docs/aggregate-root/" class=" active ">Aggregate Root</a> <ul class="sub_section"> <li><a href="/akka-ddd/docs/aggregate-root/#Logical" class="">Logical Model</a></li> <li><a href="/akka-ddd/docs/aggregate-root/#Implementation" class="">Implementation</a></li> <li><a href="/akka-ddd/docs/aggregate-root/#AggregateRootActor" class="">Actor</a></li> <li><a href="/akka-ddd/docs/aggregate-root/#Office" class="">Office</a></li> <li><a href="/akka-ddd/docs/aggregate-root/#Configuration" class="">Configuration</a></li></ul></li> <li><a href="/akka-ddd/docs/projections.html" class="">Projections</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/pawelkaczor/akka-ddd"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/pawelkaczor/akka-ddd"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Akka-DDD Scala CQRS/ES framework');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Akka-DDD Scala CQRS/ES framework');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="pawelkaczor" data-github-repo="akka-ddd"><div class="content-wrapper"><section><h2 id="logical-model"><a name="Logical"></a>Logical model</h2>

<p>The logical model of the Aggregate Root is purely behavioral. The Aggregate Root exposes a set of business operations (commands) related to a business entity. When a command is received, it is validated against the current state of the AR and either is accepted or rejected. If a command is accepted, an event (or a sequence of events) is stored in the AR journal and the state of the AR is changed. The state of the AR is its internal property, that can never be accessed directly from the outside of the AR. Thus, the structure of the AR (the structure of the AR state) is not a property of the AR logical model.</p>

<p>The logical model of the AR can only be defined as a set of behavior scenarios, each expressed in the following form:</p>

<h4 id="behavior-scenario">Behavior scenario</h4>

<h5 id="given">Given</h5>

<ul>
  <li>a sequence of commands CG-1…CG-n accepted</li>
</ul>

<h5 id="when">When</h5>

<ul>
  <li>a command CR received</li>
</ul>

<h5 id="then">Then</h5>

<ul>
  <li>either:
    <ul>
      <li>an event E (or a sequence of events E-1…E-n) stored in the AR journal</li>
    </ul>
  </li>
  <li>or
    <ul>
      <li>the command CR rejected due to a reason R</li>
    </ul>
  </li>
</ul>

<p>It turns out that the AR logical model defined as a set of AR behavior scenarios is a perfectly valid, complete specification of the Unit Test that the AR implementation should be accompanied by. See: <a href="">Testing Aggregate Roots</a></p>

<h2 id="implementation"><a name="Implementation"></a>Implementation</h2>

<p>The Akka-DDD framework allows to model the behavior of the AR as a state machine using the <a href="">algebraic data type</a>. Each type must extend from the <a href="">AggregateActions</a> trait and implement the <code class="highlighter-rouge">actions</code> method as shown in the example below.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">actions</span> <span class="k">=</span>
  <span class="n">handleCommand</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">ChangeValue</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">newValue</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="n">rejectNegative</span><span class="o">(</span><span class="n">newValue</span><span class="o">)</span> <span class="n">orElse</span> <span class="nc">ValueChanged</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">newValue</span><span class="o">)</span>
    
      <span class="k">case</span> <span class="nc">Reset</span><span class="o">(</span><span class="n">id</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">ValueChanged</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">}</span>
  <span class="o">.</span><span class="n">handleEvent</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">ValueChanged</span><span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">newValue</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="n">copy</span><span class="o">(</span><span class="n">value</span> <span class="k">=</span> <span class="n">newValue</span><span class="o">)</span>
  <span class="o">}</span>
</code></pre>
</div>
<p>The command processing logic consists of two parts: <strong>command handling (reaction)</strong> and <strong>event handling (state transition)</strong>. The <code class="highlighter-rouge">actions</code> method is a factory of the <code class="highlighter-rouge">Command Handler</code> and <code class="highlighter-rouge">Event Handler</code> functions. It creates an instance of <a href="">Actions</a> containing given <code class="highlighter-rouge">Command Handler</code> and <code class="highlighter-rouge">Event Handler</code> functions.</p>

<h3 id="command-handling-reaction">Command Handling (reaction)</h3>

<p>The actual command handling logic (the <code class="highlighter-rouge">Command Handler</code>) is a partial function that accepts a <code class="highlighter-rouge">Command</code> and returns a <code class="highlighter-rouge">Reaction</code>. The <code class="highlighter-rouge">Reaction</code> that indicates the acceptance of a command can be constructed from an event or a sequence of events. The <code class="highlighter-rouge">Reaction</code> that indicates the <a href="">rejection</a> of a command can be created by providing a rejection reason.</p>

<h4 id="command-acceptance">Command Acceptance</h4>

<p>The command handler indicates that the command is accepted by returning an Event.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">AddParticipant</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">ParticipantAdded</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span>
</code></pre>
</div>

<p>Sometimes a single event is not enough. You can build a sequence of events in many ways, for example by transforming an existing sequence of an arbitrary type.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">RemoveAllParticipants</span><span class="o">(</span><span class="n">id</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="k">this</span><span class="o">.</span><span class="n">participants</span>  
    <span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="n">name</span> <span class="k">=&gt;</span> <span class="nc">ParticipantRemoved</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="o">}</span>

<span class="c1">// Notice that `participants` is a property of the current state.
</span></code></pre>
</div>

<p>You can also use a special ‘&amp;’ operator to build a sequence of events from scratch.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">Reset</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="nc">NameChanged</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="o">&amp;</span> <span class="nc">ValueChanged</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">version</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>

<span class="c1">// Notice that `version` is a property of the current state.
</span></code></pre>
</div>

<h4 id="command-rejection">Command Rejection</h4>

<p>There are two ways to reject a command. The first way is to omit the command handler implementation. In this case, the command will be rejected automatically with a rejection reason of type <a href="">CommandHandlerNotDefined</a>.</p>

<p>To indicate explicitly that a command must be rejected (for example due to a validation error), the command handler should return a rejection reason of type <a href="">DomainException</a> or its subtype.</p>

<p>The <code class="highlighter-rouge">reject</code> method should be used to create a rejection:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="n">anyCommand</span>  <span class="k">=&gt;</span>
  <span class="n">reject</span> <span class="o">(</span><span class="nc">LotteryHasAlreadyAWinner</span><span class="o">(</span><span class="n">s</span><span class="s">"Lottery has already a winner and the winner is $winner"</span><span class="o">))</span>

</code></pre>
</div>

<p>It is also possible to pass a message to the <code class="highlighter-rouge">reject</code> method. In this case a rejection of type <a href="">DomainException</a> will be created automatically:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">Run</span><span class="o">(</span><span class="k">_</span><span class="o">)</span>  <span class="k">=&gt;</span>
  <span class="n">reject</span><span class="o">(</span><span class="s">"Lottery has no participants"</span><span class="o">)</span>

</code></pre>
</div>

<p>To keep the implementation of the command handler concise, <code class="highlighter-rouge">rejectIf</code> method can be used as shown below:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">CreateDummy</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">rejectIf</span><span class="o">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">,</span> <span class="s">"negative value not allowed"</span><span class="o">)</span> <span class="n">orElse</span>
    <span class="nc">DummyCreated</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>

</code></pre>
</div>

<p>Again you can either pass a message or a custom rejection reason to the <code class="highlighter-rouge">rejectIf</code> method.</p>

<h4 id="collaboration-with-external-actors">Collaboration with external actors</h4>

<p>Sometimes the command handling logic is more complex and requires the AR Actor to collaborate with other Actors. In such cases the <code class="highlighter-rouge">Reaction</code> needs to be implemented as a method of the AR Actor and exposed as a property of type <code class="highlighter-rouge">Reaction</code> of the <a href="">Aggregate Root configuration</a> object. The command handler will simply return the <code class="highlighter-rouge">Reaction</code> that is available in the AR configuration.</p>

<p>The example of collaboration implementation can be found in the DummyAggregateRoot Actor:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>DummyAggregateRoot code
</code></pre>
</div>

<p>Finally, the implementation of the command handler:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">GenerateValue</span><span class="o">(</span><span class="k">_</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="n">ctx</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">valueGeneration</span>
</code></pre>
</div>

<h3 id="event-handling-state-transition">Event handling (state transition)</h3>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="nc">ParticipantRemoved</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="k">val</span> <span class="n">newParticipants</span> <span class="k">=</span> <span class="n">participants</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span> <span class="o">!=</span> <span class="n">name</span><span class="o">)</span>
  <span class="c1">// NOTE: if last participant is removed, transition back to EmptyLottery
</span>  <span class="k">if</span> <span class="o">(</span><span class="n">newParticipants</span><span class="o">.</span><span class="n">isEmpty</span><span class="o">)</span>
    <span class="nc">EmptyLottery</span>
  <span class="k">else</span>
    <span class="n">copy</span><span class="o">(</span><span class="n">participants</span> <span class="k">=</span> <span class="n">newParticipants</span><span class="o">)</span>

</code></pre>
</div>

<h3 id="behavior-composition">Behavior composition</h3>

<h2 id="aggregate-root-actor"><a name="AggregateRootActor"></a>Aggregate Root Actor</h2>

<p><a href="">Aggregate Root Actor</a> is responsible for running the Aggregate Root state machine (the AR behavior). It is a <a href="">Persistent Actor</a>.
When a <a href="">Command Messages</a> comes in, the actor invokes the current <a href="">Command Handler</a> (the Command Handler associated with the current state) and if the command is accepted, appends the <a href="">Event Message</a>(s) to the actor’s journal. Once the event message(s) is persisted, the AR actor invokes the current <a href="">Event Handler</a> (the Event Handler associated with the current state) and the AR transitions to the next state.</p>

<p>Aggregate Root Actors are not directly accessible by the clients. They are like clerks working in the office. The only way to perform an operation on a particular Aggregate Root (a business entity / case) is to submit a form (command) to the respective Office.</p>

<h2 id="office"><a name="Office"></a>Office</h2>

<p>TODO</p>

<p>The office should publish its identifier to be used across the system by the service consumers and client applications.
The office identifier should allow obtaining the identifier of the office journal and the identifiers of the journals of the individual business entities (cases).</p>

<p>Akka-DDD provides the [RemoteOfficeId] class to be used for that purpose.</p>

<p>The identifier of the sample <a href="">Reservation office</a> is shown below:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="nc">RemoteOfficeId</span><span class="o">(</span>
    <span class="n">id</span>           <span class="k">=</span> <span class="s">"Reservation"</span><span class="o">,</span>
    <span class="n">department</span>   <span class="k">=</span> <span class="s">"Sales"</span><span class="o">,</span>
    <span class="n">messageClass</span> <span class="k">=</span> <span class="n">classOf</span><span class="o">[</span><span class="kt">sales.Command</span><span class="o">]</span>
<span class="o">)</span>
</code></pre>
</div>

<p>The messageClass property defines the base class of all message classes that the office is ready to handle (this information helps to auto-configure the command dispatching that is performed by the write-front application).</p>

<h3 id="office-creation">Office creation</h3>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="nc">OfficeFactory</span><span class="o">.</span><span class="n">office</span><span class="o">[</span><span class="kt">Reservation</span><span class="o">]</span>
</code></pre>
</div>

<p>Assuming the <code class="highlighter-rouge">newicom.dddd.cluster</code> package object is available in the scope (the package object is imported), the actual office creation is delegated to the cluster-aware / sharding-capable OfficeFactory object that is injected automatically as an implicit argument of the office method. The office factory requires an <code class="highlighter-rouge">AR Actor Factory</code> and a shard allocation strategy to be implicitly provided for the given AR Actor class. For the <code class="highlighter-rouge">Reservation</code> these objects are defined in the <a href="">SalesBackendConfiguration</a> trait that the <a href="">SalesBackendApp</a> mixes-in. The <code class="highlighter-rouge">Office</code> object that is eventually created contains the office identifier and the address (in the form of an ActorPath) of the office representative Actor.</p>

<h2 id="configuration"><a name="Configuration"></a>Configuration</h2>

<p>When creating a class of the Aggregate Root Actor or the root trait of the Aggregate Root behavior, it is necessary to declare
the AR configuration interface. If you do not intend to extend the default AR configuration interface, just use the <code class="highlighter-rouge">Config</code> trait as show in the examples below:</p>

<p>Root trait of the Reservation AR behavior:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">sealed</span> <span class="k">trait</span> <span class="nc">ReservationActions</span> <span class="k">extends</span> <span class="nc">AggregateActions</span><span class="o">[</span><span class="kt">Event</span>, <span class="kt">ReservationActions</span>, <span class="kt">Config</span><span class="o">]</span> 
</code></pre>
</div>

<p>Reservation AR Actor:</p>
<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Reservation</span><span class="o">(</span><span class="k">val</span> <span class="n">config</span><span class="k">:</span> <span class="kt">Config</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">AggregateRoot</span><span class="o">[</span><span class="kt">Event</span>, <span class="kt">ReservationActions</span>, <span class="kt">Reservation</span><span class="o">]</span> <span class="k">with</span> <span class="nc">ConfigClass</span><span class="o">[</span><span class="kt">Config</span><span class="o">]</span>
</code></pre>
</div>

<p>The default configuration interface exposes two properties: <code class="highlighter-rouge">PassivationConfig</code> and <code class="highlighter-rouge">RespondingPolicy</code>.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Config</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">pc</span><span class="k">:</span> <span class="kt">PassivationConfig</span>
  <span class="k">def</span> <span class="n">respondingPolicy</span><span class="k">:</span> <span class="kt">RespondingPolicy</span>
<span class="o">}</span>
</code></pre>
</div>
<p>The <code class="highlighter-rouge">DefaultConfig</code> defines a <code class="highlighter-rouge">replyWithEvents</code> flag, that you should set to false if the <code class="highlighter-rouge">SparseReply</code> responding policy should be used instead of the default one (<code class="highlighter-rouge">ReplyWithEvents</code>).</p>

<p>The AR Actor Factory is responsible for creating and <strong>configuring</strong> the AR Actor:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">implicit</span> <span class="k">object</span> <span class="nc">ReservationARFactory</span> <span class="k">extends</span> <span class="nc">AggregateRootActorFactory</span><span class="o">[</span><span class="kt">Reservation</span><span class="o">]</span> <span class="o">{</span>
    <span class="k">override</span> <span class="k">def</span> <span class="n">props</span><span class="o">(</span><span class="n">pc</span><span class="k">:</span> <span class="kt">PassivationConfig</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">Reservation</span><span class="o">(</span><span class="nc">DefaultConfig</span><span class="o">(</span><span class="n">pc</span><span class="o">,</span> <span class="n">replyWithEvents</span> <span class="k">=</span> <span class="kc">false</span><span class="o">)))</span>
  <span class="o">}</span>
</code></pre>
</div>

<h3 id="responding-policy">Responding Policy</h3>

<p><a href="">RespondingPolicy</a> trait defines the <code class="highlighter-rouge">successMapper</code> function. The function is responsible for creating a response message that the command sender receives in case the command is accepted.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">RespondingPolicy</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">SuccessMapper</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Seq</span><span class="o">[</span><span class="kt">OfficeEventMessage</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="nc">Any</span>
  <span class="k">def</span> <span class="n">successMapper</span><span class="k">:</span> <span class="kt">SuccessMapper</span>
<span class="o">}</span>
</code></pre>
</div>

<p>You can define a custom Responding Policy by providing your own implementation of the <code class="highlighter-rouge">RespondingPolicy</code> trait or you can use one of the built-in policies:</p>

<ul>
  <li><a href="">SparseReply</a> - a generic message is returned</li>
  <li><a href="">ReplyWithEvents</a> - the sequence of <a href="">OfficeEventMessage</a> is returned</li>
</ul>

<h3 id="passivation">Passivation</h3>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/akka-ddd/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'pawelkaczor/akka-ddd'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/akka-ddd/js/main.js"></script><script src="/akka-ddd/js/kazari.js"></script><script>
$(document).ready(function() {
	kazari.KazariPlugin().decorateCode('https://scala-evaluator-212.herokuapp.com/eval', 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.S2F6YXJp.Jl2eqMfw8IakJF93PjxTbrf-8YUJgX5OoOfy5JHE8Yw', '', 'monokai')
})
    </script></body></html>